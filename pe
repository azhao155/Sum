https://www.1point3acres.com/bbs/forum.php?mod=viewthread&tid=472625&highlight=fb%2Bpe
https://www.1point3acres.com/bbs/forum.php?mod=viewthread&tid=561690&highlight=fb%2Bpe


User vs Kernel:

User mode and kernel mode are terms that may refer specifically to the processor execution mode. Code that runs in kernel mode can fully [1] control the CPU while code that runs in user mode has certain limitations. For example, local CPU interrupts can only be disabled or enable while running in kernel mode. If such an operation is attempted while running in user mode an exception will be generated and the kernel will take over to handle it.


The application is setting up the system call number and parameters and it issues a trap instruction
The execution mode switches from user to kernel; the CPU switches to a kernel stack; the user stack and the return address to user space is saved on the kernel stack
The kernel entry point saves registers on the kernel stack
The system call dispatcher identifies the system call function and runs it
The user space registers are restored and execution is switched back to user (e.g. calling IRET)
The user space application resumes

SystemCall
The application is setting up the system call number and parameters and it issues a trap instruction
The execution mode switches from user to kernel; the CPU switches to a kernel stack; the user stack and the return address to user space is saved on the kernel stack
The kernel entry point saves registers on the kernel stack
The system call dispatcher identifies the system call function and runs it
The user space registers are restored and execution is switched back to user (e.g. calling IRET)
The user space application resumes

Interrupt:
Synchronous interrupts, usually named exceptions, handle conditions detected by the processor itself in the course of executing an instruction. Divide by zero or a system call are examples of exceptions.

Asynchronous interrupts, usually named interrupts, are external events generated by I/O devices. For example a network card generates an interrupts to signal that a packet has arrived.

